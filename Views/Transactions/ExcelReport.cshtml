@{
    ViewData["Title"] = "Excel Report";
    var today = DateTime.Today;
    var previousMonthSet = today.AddMonths(-1);

    var actualMonth = today.Month;
    var actualYear = today.Year;

    var previousMonth = previousMonthSet.Month;
    var previousMonthYear = previousMonthSet.Year;

    var previousYear = actualYear - 1;
}

<partial name="_Submenu" Model="SubmenuTransactions.Excel" />

<h1 class="mb-3">Export transactions to Excel</h1>

<div class="mb-3">
    <a asp-action="ExportToExcelFile" asp-route-month="@actualMonth" asp-route-year="@actualYear" class="btn btn-success">

    Export actual month
    </a>
        ~ @today.ToString("MMMM yyyy")
</div>


<div class="mb-3">
    <a asp-action="ExportToExcelFile" asp-route-month="@previousMonth" asp-route-year="@previousMonthYear" class="btn btn-success">

        Export previous month
    </a>
    ~ @previousMonthSet.ToString("MMMM yyyy")
</div>

<div class="mb-3">
    <a asp-action="ExportToExcelFileByYear" asp-route-year="@actualYear"
       class="btn btn-success">
        Exportar actual year
    </a> ~ @actualYear
</div>

<div class="mb-3">
    <a asp-action="ExportToExcelFileByYear" asp-route-year="@previousYear"
       class="btn btn-success">
        Export previous year
    </a> ~ @previousYear
</div>

<div class="mb-3">
    <a asp-action="ExportToExcelFileAll"
       class="btn btn-success">
        Export all
    </a>
</div>